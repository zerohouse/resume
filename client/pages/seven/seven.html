<div class="container">
    <h3>7 게임
        <small ng-show="game.ing">게임중 : {{game.turn}}번째 순서</small>
        <small ng-show="!game.ing">대기중 : 3명이상이 참여하면 시작합니다.</small>
        {{time}}
        <div class="btn btn-sm btn-success" ng-show="!player.in" ng-click="player.in = true">게임참여</div>
        <div class="btn btn-sm btn-danger" ng-show="player.in" ng-click="player.in = false">관전</div>
        <div class="btn btn-sm btn-primary" popup="sevenrooms">방목록</div>
    </h3>

    <div class="panel panel-primary" ng-show="players.length!=0">
        <div class="panel-heading">관전자</div>
        <ul class="list-group">
            <li class="list-group-item" ng-click="setTo(p)"
                ng-class="{'list-group-item-success':player == p}"
                ng-repeat="p in orderedPlayers = (players | orderBy: 'score':true)">
                {{p.name||"플레이어"}} <span class="label"
                                         ng-class="{'label-success':p!=player&&p.in,'label-danger':!p.in,'label-primary':p.in&&p==player}">
                <span ng-show="p.in">참가예정</span>
                <span ng-show="!p.in">관전</span></span>
                <span class="badge">{{p.score||0}}</span>
            </li>
        </ul>
    </div>


    <div class="game" ng-show="game.ing">
        <div class="players">
            <div class="player" ng-click="setTo(p)"
                 ng-repeat="p in inPlayers">
                <div><i class="fa fa-user fa-5x"></i></div>
                {{p.name||"플레이어"}} <span class="badge">{{p.score||0}}</span>

                <div class="label label-danger disconnect" ng-show="p.disconnect">연결끊김</div>

                <div ng-show="p.submitted !== undefined">
                    <card ng-click="open(p)" ng-class="{flipped:p.submitted===true || !p.open}"
                          front="p.submitted"></card>
                </div>

            </div>
        </div>
        <div class="chips wrap-block">
            <h3>{{game.point}} chips</h3>

            <div class="blue chip" ng-repeat="chip in bluechips"></div>
            <div class="black chip" ng-repeat="chip in blackchips"></div>
        </div>

        <div class="mycard">
            <card ng-show="game.submitted!==undefined" front="game.submitted"></card>
        </div>


        <div class="card-dek wrap-block">
            <card class="card-hover" ng-style="cardStyle(player.cards.indexOf(card))" front="card"
                  ng-repeat="card in player.cards" ng-click="submit(player.cards.indexOf(card))"></card>
            <div class="myscore">{{player.name}} <span class="badge">{{player.score}}</span></div>
        </div>

    </div>

    <div class="panel panel-primary">
        <div class="panel-heading">말하기
        </div>
        <ul class="list-group chat-window chat">
            <li class="list-group-item" ng-repeat="message in messages"
                ng-class="{'list-group-item-danger':message.to}">
                <div ng-show="message.to.sid != player.sid" class="btn btn-primary" ng-click="setTo(message.from)">
                    {{message.from.name}}<span ng-show="message.fromme">님에게</span></div>
                <div class="btn btn-primary" ng-click="setTo(message.from)" ng-show="message.to.sid == player.sid">
                    {{message.from.name}}님의 메시지</span></div>
                {{message.message}}
                <small>{{message.date.toDateString()}}</small>
            </li>
        </ul>
        <div class="panel-footer">
            <div class="input-group" ng-class="{whisper:message.to}">
                <div class="input-group-addon" ng-show="message.to">{{message.to.name}}님에게 <i class="fa fa-times"
                                                                                              ng-click="message.to=undefined"></i>
                </div>
                <input class="form-control" ng-enter="send(message);" ng-model="message.message">

                <div class="input-group-addon" ng-click="send(message);">말하기</div>
            </div>
        </div>
    </div>

    <div class="panel panel-primary">
        <div class="panel-heading">게임 기록</div>
        <ul class="list-group chat-window">
            <li class="list-group-item" ng-repeat="log in logs">{{log.message}}</li>
        </ul>
    </div>

    <div class="panel panel-primary">
        <div class="panel-heading">규칙 : 7 게임 ( 3~8인 )</div>
        <ul class="list-group chat-window">
            <li class="list-group-item">게임 시작시 모든 플레이어는 카드 10장을 받습니다. [0,1,2,3,4,5,6,7,EYE,X]</li>
            <li class="list-group-item">한 게임은 총 9 라운드로 진행되며 각 라운드에 모든 플레이어는 칩을 1개씩 배팅합니다.</li>
            <li class="list-group-item">각 라운드는 다음과 같이 진행됩니다.</li>
            <li class="list-group-item">모든 플레이어는 카드를 한장씩 냅니다.</li>
            <li class="list-group-item">모두 낸 후 플레이어들의 카드를 확인합니다.</li>
            <li class="list-group-item">EYE 카드를 낸 플레이어가 있을 경우 해당 플레이어들은 다른 플레이어들의 카드를 확인한 뒤 자신의 카드를 선택합니다.</li>
            <li class="list-group-item">X카드를 낸 플레이어가 있으면, 칩을 그대로 둔 채 다음 라운드를 진행합니다.</li>
            <li class="list-group-item">X카드가 없고 숫자가 높은 플레이어가 한명이면 승리하고 칩을 가져갑니다.</li>
            <li class="list-group-item">가장 높은 카드를 낸 플레이어가 여러명이면이고 0카드를 낸 플레이어가 없다면 칩을 그대로 둔 채 다음 라운드를 진행합니다.</li>
            <li class="list-group-item">가장 높은 카드를 낸 플레이어가 여러명이고, X카드를 낸 플레이어가 없다면, 0카드를 낸 플레이어가 승자가 됩니다.</li>
            <li class="list-group-item">0카드로 승리한 플레이어가 여러명일 경우 칩을 나누어 가지고 나누어지지 않는 나머지만 다음 라운드로 넘깁니다.</li>
            <li class="list-group-item">1,2,3카드로 승리했을경우 다른 플레이어들에게 다른 플레이어에게 칩 1개를 추가로 받습니다.</li>
            <li class="list-group-item">9라운드가 지나 카드를 모두 내면 게임이 종료됩니다.</li>
            <li class="list-group-item">9라운드에 승자가 없으면 칩을 그대로 둔채 다음 게임에 사용합니다.</li>
        </ul>
    </div>

</div>


